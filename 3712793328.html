

<!DOCTYPE html>
<html lang="en" data-default-color-scheme="auto">



<head>
  <meta charset="UTF-8">

  <link rel="apple-touch-icon" sizes="76x76" href="/img/fluid.png">
  <link rel="icon" href="/img/fluid.png">
  

  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=5.0, shrink-to-fit=no">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  
  <meta name="theme-color" content="#2f4154">
  <meta name="author" content="FangZhou">
  <meta name="keywords" content="Vue,React,Nodejs,blogs,frontend,web,developer,programmer">
  
    <meta name="description" content="计算机网络">
<meta property="og:type" content="article">
<meta property="og:title" content="计算机网络沉淀心得">
<meta property="og:url" content="http://arkpln.github.io/3712793328.html">
<meta property="og:site_name" content="Ark的技术博客">
<meta property="og:description" content="计算机网络">
<meta property="og:locale" content="en_US">
<meta property="og:image" content="http://arkpln.github.io/images/cn.jpg">
<meta property="article:published_time" content="2026-01-26T03:43:02.000Z">
<meta property="article:modified_time" content="2026-02-12T09:38:37.969Z">
<meta property="article:author" content="FangZhou">
<meta property="article:tag" content="network">
<meta name="twitter:card" content="summary_large_image">
<meta name="twitter:image" content="http://arkpln.github.io/images/cn.jpg">
  
  
  
  <title>计算机网络沉淀心得 - Ark的技术博客</title>

  <link rel="stylesheet" href="https://lib.baomitu.com/twitter-bootstrap/4.6.1/css/bootstrap.min.css">



  <link rel="stylesheet" href="https://lib.baomitu.com/github-markdown-css/4.0.0/github-markdown.min.css">

  <link rel="stylesheet" href="https://lib.baomitu.com/hint.css/2.7.0/hint.min.css">

  <link rel="stylesheet" href="https://lib.baomitu.com/fancybox/3.5.7/jquery.fancybox.min.css">



<!-- 主题依赖的图标库，不要自行修改 -->
<!-- Do not modify the link that theme dependent icons -->

<link rel="stylesheet" href="//at.alicdn.com/t/c/font_1749284_5i9bdhy70f8.css">



<link rel="stylesheet" href="//at.alicdn.com/t/c/font_1736178_k526ubmyhba.css">


<link rel="stylesheet" href="/css/main.css">


  <link id="highlight-css" rel="stylesheet" href="/css/highlight.css">
  
    <link id="highlight-css-dark" rel="stylesheet" href="/css/highlight-dark.css">
  




  <script id="fluid-configs">
    var Fluid = window.Fluid || {};
    Fluid.ctx = Object.assign({}, Fluid.ctx)
    var CONFIG = {"hostname":"arkpln.github.io","root":"/","version":"1.9.8","typing":{"enable":true,"typeSpeed":70,"cursorChar":"_","loop":false,"scope":[]},"anchorjs":{"enable":true,"element":"h1,h2,h3,h4,h5,h6","placement":"left","visible":"hover","icon":""},"progressbar":{"enable":true,"height_px":3,"color":"#29d","options":{"showSpinner":false,"trickleSpeed":100}},"code_language":{"enable":true,"default":"TEXT"},"copy_btn":true,"image_caption":{"enable":true},"image_zoom":{"enable":true,"img_url_replace":["",""]},"toc":{"enable":true,"placement":"right","headingSelector":"h1,h2,h3,h4,h5,h6","collapseDepth":0},"lazyload":{"enable":true,"loading_img":"/img/loading.gif","onlypost":false,"offset_factor":2},"web_analytics":{"enable":true,"follow_dnt":true,"baidu":null,"google":{"measurement_id":null},"tencent":{"sid":null,"cid":null},"leancloud":{"app_id":"mEwkD7geCX7RWNO8srhDE2oP-gzGzoHsz","app_key":"4EF76hyiVA1QILHZThVbfoat","server_url":"https://mewkd7ge.lc-cn-n1-shared.com","path":"window.location.pathname","ignore_local":false},"umami":{"src":null,"website_id":null,"domains":null,"start_time":"2024-01-01T00:00:00.000Z","token":null,"api_server":null}},"search_path":"/local-search.xml","include_content_in_search":true};

    if (CONFIG.web_analytics.follow_dnt) {
      var dntVal = navigator.doNotTrack || window.doNotTrack || navigator.msDoNotTrack;
      Fluid.ctx.dnt = dntVal && (dntVal.startsWith('1') || dntVal.startsWith('yes') || dntVal.startsWith('on'));
    }
  </script>
  <script src="/js/utils.js"></script>
  <script src="/js/color-schema.js"></script>
  

  

  

  

  

  
    
  



  <meta name="google-site-verification" content="5KfTZvtlydmBIzY97rVo-caP5jljAfmD3Qs3sBzY2Go"><style>ins.adsbygoogle[data-ad-status="unfilled"] { display: none !important; }</style>
<meta name="generator" content="Hexo 7.3.0"></head>


<body>
  

  <header>
    

<div class="header-inner" style="height: 70vh;">
  <nav id="navbar" class="navbar fixed-top  navbar-expand-lg navbar-dark scrolling-navbar">
  <div class="container">
    <a class="navbar-brand" href="/">
      <strong>Ark的技术博客</strong>
    </a>

    <button id="navbar-toggler-btn" class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarSupportedContent" aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation">
      <div class="animated-icon"><span></span><span></span><span></span></div>
    </button>

    <!-- Collapsible content -->
    <div class="collapse navbar-collapse" id="navbarSupportedContent">
      <ul class="navbar-nav ml-auto text-center">
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/" target="_self">
                <i class="iconfont icon-home-fill"></i>
                <span>快乐老家</span>
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/archives/" target="_self">
                <i class="iconfont  icon-archive-fill"></i>
                <span>笔岚档案</span>
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/categories/" target="_self">
                <i class="iconfont icon-category-fill"></i>
                <span>文以类聚</span>
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/tags/" target="_self">
                <i class="iconfont icon-tags-fill"></i>
                <span>按标签阅览</span>
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/about/" target="_self">
                <i class="iconfont icon-user-fill"></i>
                <span>联系我</span>
              </a>
            </li>
          
        
        
          <li class="nav-item" id="search-btn">
            <a class="nav-link" target="_self" href="javascript:;" data-toggle="modal" data-target="#modalSearch" aria-label="Search">
              <i class="iconfont icon-search"></i>
            </a>
          </li>
          
        
        
          <li class="nav-item" id="color-toggle-btn">
            <a class="nav-link" target="_self" href="javascript:;" aria-label="Color Toggle">
              <i class="iconfont icon-dark" id="color-toggle-icon"></i>
            </a>
          </li>
        
      </ul>
    </div>
  </div>
</nav>

  

<div id="banner" class="banner" parallax="true" style="background: url('/images/cn.jpg') no-repeat center center; background-size: cover;">
  <div class="full-bg-img">
    <div class="mask flex-center" style="background-color: rgba(0, 0, 0, 0.3)">
      <div class="banner-text text-center fade-in-up">
        <div class="h2">
          
            <span id="subtitle" data-typed-text="计算机网络沉淀心得"></span>
          
        </div>

        
          
  <div class="mt-3">
    
    
      <span class="post-meta">
        <i class="iconfont icon-date-fill" aria-hidden="true"></i>
        <time datetime="2026-01-26 11:43" pubdate>
          January 26, 2026 am
        </time>
      </span>
    
  </div>

  <div class="mt-1">
    
      <span class="post-meta mr-2">
        <i class="iconfont icon-chart"></i>
        
          15k words
        
      </span>
    

    
      <span class="post-meta mr-2">
        <i class="iconfont icon-clock-fill"></i>
        
        
        
          125 mins
        
      </span>
    

    
    
  </div>


        
      </div>

      
    </div>
  </div>
</div>

</div>

  </header>

  <main>
    
      

<div class="container-fluid nopadding-x">
  <div class="row nomargin-x">
    <div class="side-col d-none d-lg-block col-lg-2">
      
<aside class="sidebar d-none d-xl-block" style="margin-right:-1rem;z-index:-1"><ins class="adsbygoogle" style="display:flex;justify-content:center;min-width:160px;max-width:300px;width:100%;height:600px;position:sticky;top:2rem" data-ad-client="ca-pub-3240358922862141" data-ad-slot="6522434837"></ins><script> (adsbygoogle = window.adsbygoogle || []).push({}); </script></aside>
    </div>

    <div class="col-lg-8 nopadding-x-md">
      <div class="container nopadding-x-md" id="board-ctn">
        <div id="board">
          <article class="post-content mx-auto">
            <h1 id="seo-header">计算机网络沉淀心得</h1>
            
            
              <div class="markdown-body">
                
                <h1 id="计算机网络沉淀心得"><a href="#计算机网络沉淀心得" class="headerlink" title="计算机网络沉淀心得"></a>计算机网络沉淀心得</h1><h2 id="OSI七层网络模型"><a href="#OSI七层网络模型" class="headerlink" title="OSI七层网络模型"></a>OSI七层网络模型</h2><h3 id="结构总述"><a href="#结构总述" class="headerlink" title="结构总述"></a>结构总述</h3><ul>
<li><p>网络接口层&#x2F;数据链路层</p>
<ul>
<li><p>物理层 -&gt; IEEE820.1</p>
</li>
<li><p>数据链路层 -&gt; FDDO,Ethernet,PPP</p>
</li>
</ul>
</li>
<li><p>网络层</p>
<ul>
<li>网络层 -&gt; IP,ICMP,ARP,RIP</li>
</ul>
</li>
<li><p>传输层</p>
<ul>
<li>传输层 -&gt;TCP,UDP</li>
</ul>
</li>
<li><p>应用层</p>
<ul>
<li><p>会话层 -&gt;SSL,TLS</p>
</li>
<li><p>表示层 -&gt; JPEG,ASCII,DECOIC,加密</p>
</li>
<li><p>应用层 -&gt; HTTP,FTP,SNMP,DNS</p>
</li>
</ul>
</li>
</ul>
<h3 id="物理层"><a href="#物理层" class="headerlink" title="物理层"></a>物理层</h3><p>物理层是直接与物理介质打交道的</p>
<p>在这一层<em>光,电,无线电波</em>获取传送信号,电压,转换成数字信号,在这一层主要传输<strong>比特流</strong></p>
<p>物理层设备:</p>
<ul>
<li><p>网卡</p>
</li>
<li><p>网线</p>
</li>
<li><p>集线器,中继器</p>
</li>
<li><p>调制解调器</p>
</li>
</ul>
<p>物理层信道:</p>
<ul>
<li><p>明线(有线导线)</p>
</li>
<li><p>对称电缆</p>
</li>
<li><p>同轴电缆(最广泛)</p>
</li>
<li><p>光纤(光信号传导信号)</p>
</li>
<li><p>无线电波(WiFi,卫星)</p>
</li>
</ul>
<h3 id="数据链路层"><a href="#数据链路层" class="headerlink" title="数据链路层"></a>数据链路层</h3><p><strong>功能:</strong> 建立逻辑连接,进行硬件地址选址,差错检验.将比特组合成字节进而合成帧（<strong>数据帧</strong>）,使用MAC地址访问介质,发现错误但不能纠正。</p>
<p><strong>MAC地址：</strong> 每个网卡的唯一标识</p>
<p>设备:</p>
<ul>
<li>交换机</li>
</ul>
<h3 id="网络层"><a href="#网络层" class="headerlink" title="网络层"></a>网络层</h3><p>网络层是最复杂的一层，在这一层就定义了我们的IP。该层控制数据链路层与传输层之间的信息转发，建立、维持和终止网络的连接。具体地说，数据链路层的数据在这一层被转换为数据包，然后通过路径选择、分段组合、顺序、进&#x2F;出路由等控制，将信息从一个网络设备传送到另一个网络设备</p>
<p><strong>IP网址的原因:</strong></p>
<p>在数据链路层，如果所有的使用互联网的用户在同一个网段中，会产生广播风暴，所以要将用户进行划分，让他们在不同的网段中，自己在自己的小网段中广播。而互联网就是这无数的子网络构成的一个巨型网络。</p>
<p>在网络层中引入了一套新的地址，让我们能够区分不同的网段。这套地址就叫做“网络地址”，简称“网址”。于是，”网络层”出现以后，每台计算机有了两种地址，一种是MAC地址，另一种是网络地址。两种地址之间没有任何联系，MAC地址是绑定在网卡上的，网络地址则是管理员分配的，它们只是随机组合在一起。</p>
<p>网络地址帮助我们确定计算机所在的子网络，MAC地址则将数据包送到该子网络中的目标网卡。因此，从逻辑上可以推断，必定是先处理网络地址，然后再处理MAC地址。</p>
<p><strong>功能:</strong> </p>
<ul>
<li><p>寻址：对网络层而言使用IP地址来唯一标识互联网上的设备，网络层依靠IP地址进行相互通信（类似于数据链路层的MAC地址）</p>
</li>
<li><p>路由：在同一个网络中的内部通信并不需要网络层设备，仅仅靠数据链路层就可以完成相互通信，对于不同的网络之间相互通信则必须借助路由器等三层设备。</p>
</li>
</ul>
<p><strong>设备:</strong></p>
<ul>
<li>路由器</li>
</ul>
<p><strong>协议:</strong></p>
<ul>
<li><p>IPv4</p>
</li>
<li><p>IPv6</p>
</li>
</ul>
<h3 id="传输层"><a href="#传输层" class="headerlink" title="传输层"></a>传输层</h3><p><strong>功能：</strong></p>
<ul>
<li><p>定义端口号</p>
</li>
<li><p>控流</p>
</li>
<li><p>校验</p>
</li>
</ul>
<p><strong>协议：</strong></p>
<ul>
<li><p>TCP：面向连接的可靠协议，三次握手四次挥手</p>
</li>
<li><p>UDP：不可靠协议，但效率更高</p>
</li>
</ul>
<h3 id="会话层"><a href="#会话层" class="headerlink" title="会话层"></a>会话层</h3><p><strong>功能:</strong></p>
<p>会话层，是在发送方和接收方之间进行通信时创建、维持、之后终止或断开连接的地方，与电话通话有点相似。</p>
<p>会话层定义了一种机制，允许发送方和接收方启动或停止请求会话，以及当双方发生拥塞时仍然能保持对话。</p>
<p>会话层包含了一种称为检查点（Checkpoint）的机制来维持可靠会话。</p>
<p>检查点定义了一个最接近成功通信的点，并且定义了当发生内容丢失或损坏时需要回滚以便恢复丢失或损坏数据的点，即断点下载的原理。</p>
<p>这一层经常被叫<strong>报文</strong></p>
<h3 id="表示层"><a href="#表示层" class="headerlink" title="表示层"></a>表示层</h3><p><strong>功能：</strong></p>
<p>安全、压缩、编解码相关的功能和标准。</p>
<ul>
<li><p>ASCII，utf-8</p>
</li>
<li><p>JPEG</p>
</li>
</ul>
<p>这一层经常被叫<strong>报文</strong></p>
<h3 id="应用层"><a href="#应用层" class="headerlink" title="应用层"></a>应用层</h3><p><strong>功能：</strong> 负责为用户和应用程序提供网络服务，直接与用户交互。常见的协议有 HTTP（超文本传输协议）、FTP（文件传输协议）、SMTP（邮件传输协议）等。</p>
<p><strong>协议:</strong></p>
<ul>
<li><p>HTTP&#x2F;HTTPS</p>
</li>
<li><p>DNS</p>
</li>
<li><p>SMTP</p>
</li>
<li><p>WebSocket</p>
</li>
<li><p>SSH</p>
</li>
</ul>
<h2 id="TCP三次握手"><a href="#TCP三次握手" class="headerlink" title="TCP三次握手"></a>TCP三次握手</h2><p><a target="_blank" rel="external nofollow noopener noreferrer" href="https://imgchr.com/i/pZR9Z7T"><img src="https://s41.ax1x.com/2026/01/26/pZR9Z7T.webp" srcset="/img/loading.gif" lazyload alt="pZR9Z7T.webp"></a></p>
<ol>
<li><p>seq(sequence number)，序列号随机生成</p>
</li>
<li><p>ack(acknowledgement number)确认号ack&#x3D;seq + 1</p>
</li>
<li><p>ACK(acknowledgement)确认序列号有效</p>
</li>
<li><p>SYN(Synchronous)发起新连接</p>
</li>
</ol>
<p><strong>过程:</strong></p>
<ol>
<li><p>首先客户端会发送一个段：<code>SYN</code>报文，想跟<code>服务端</code>进行连接，并且会携带一个序列号<code>seq</code>，下次发送的数据序列号还会进行+1。此时客户端发送<code>SYN = 1 seq=x</code></p>
</li>
<li><p>服务端收到了SYN + seq 字段之后，服务端也会生成一个对应服务端seq序列号，这时候就会携带ACK确认号，表示之前的SYN 收到了，还会有一个小写的ack 把 客户端的seq + 1,此时服务端发送<code>SYN = 1,ACK = 1,seq = y,ack=x+1</code></p>
</li>
<li><p>客户端收到服务端的响应之后会发送一个ACK确定序列号有效,并且还会发送seq，这里的seq会通过算法计算出来是否跟服务端的ack值相等，然后会发送一个新的ack这里的ack是服务端的seq值+1，确保一切正常。此时客户端发送<code>ACK= 1 seq = x+1,ack = y+1</code></p>
</li>
</ol>
<p><strong>总结：</strong></p>
<p>TCP 三次握手用于在数据传输前建立可靠连接，主要目的是确认双方的收发能力并同步初始序列号。<br>第一次握手由客户端发送 SYN，请求建立连接；<br>第二次握手服务器回复 SYN+ACK，确认客户端请求并发送自己的初始序列号；<br>第三次握手客户端发送 ACK，确认服务器的 SYN。<br>至此双方都确认了彼此的发送和接收能力，连接正式建立。</p>
<h2 id="TCP四次挥手"><a href="#TCP四次挥手" class="headerlink" title="TCP四次挥手"></a>TCP四次挥手</h2><p><a target="_blank" rel="external nofollow noopener noreferrer" href="https://imgchr.com/i/pZRCgqx"><img src="https://s41.ax1x.com/2026/01/26/pZRCgqx.webp" srcset="/img/loading.gif" lazyload alt="pZRCgqx.webp"></a></p>
<ol>
<li><p>seq(sequence number)，序列号随机生成</p>
</li>
<li><p>ack（acknowledgement number）确认号ack &#x3D; seq + 1</p>
</li>
<li><p>ACK（acknowledgement）确认序列号有效</p>
</li>
<li><p>SYN(synchronous)发起新连接</p>
</li>
<li><p>FIN(FINISH)完成</p>
</li>
<li><p>断开连接服务端和客户端都可以主动发起我们拿客户端举例，客户端进行断开操作先发送<code>FIN</code>包生成客户端的<code>seq</code>序列号随后进入<code>wait1</code>状态,这是第一次挥手。客户端发送<code>FIN=1 seq=u</code></p>
</li>
<li><p>服务端收到FIN包表示自己进入了关闭等待状态，然后向客户端使用ack验证，验证成功打上ACK标记，随后生成服务端的<code>seq值</code>发送给客户端，这是第二次挥手，服务端此时还可以发送未完成的数据。服务端发送<code>ACK=1 ack=u+1</code></p>
</li>
<li><p>等待服务端所有任务操作完成之后服务端开始进入最后确认状态，向客户端发送<code>FIN包</code>,并且验证ack，使用客户端第一次的<code>seq + 1</code>去验证，验证成功打上ACK标记，并且生成一个新的序列号seq发送给客户端，这是第三次挥手。客户端发送<code>FIN seq=v ack=u+1</code></p>
</li>
<li><p>客户端收到之后进入超时等待状态<code>2MSL（1-4分钟）</code>，经过等到后客户端关闭连接，而服务端收到信息验证完成ack成功之后打上<code>ACk</code>标记随后将关闭连接。服务端发送<code>ACK=1 seq=u+1 ack=v+1 </code></p>
</li>
</ol>
<p><strong>TIME_WAIT 的两个核心作用</strong></p>
<ol>
<li>确保最后一个 ACK 能被服务器接收</li>
</ol>
<ul>
<li><p>如果服务器没收到 ACK，会重发 FIN</p>
</li>
<li><p>客户端在 TIME_WAIT 状态仍能正确响应</p>
</li>
</ul>
<ol start="2">
<li>防止旧连接的报文污染新连接</li>
</ol>
<ul>
<li><p>等待网络中所有“旧报文”自然消失</p>
</li>
<li><p>时间长度 &#x3D; <strong>2 × MSL（最大报文生存时间）</strong></p>
</li>
</ul>
<p><strong>总结:</strong></p>
<p>TCP 四次挥手用于可靠地释放连接。由于 TCP 是全双工协议，连接的两个方向需要分别关闭。<br>主动关闭方首先发送 FIN 表示不再发送数据；被动关闭方回复 ACK 确认；待其数据发送完毕后再发送 FIN；最后主动关闭方发送 ACK 确认。<br>主动关闭方进入 TIME_WAIT 状态，以确保连接可靠关闭并防止旧报文干扰新连接。</p>
<h2 id="浏览器输入url后发生了什么"><a href="#浏览器输入url后发生了什么" class="headerlink" title="浏览器输入url后发生了什么"></a>浏览器输入url后发生了什么</h2><h3 id="URL-统一资源定位符"><a href="#URL-统一资源定位符" class="headerlink" title="URL(统一资源定位符)"></a>URL(统一资源定位符)</h3><p><code>http:</code>:访问协议</p>
<p><code>www.server.com</code>:服务器名称&#x2F;域名</p>
<p><code>/dir1/</code>:路径名,目录名</p>
<p><code>file1.html</code>:文件名</p>
<h3 id="DNS解析"><a href="#DNS解析" class="headerlink" title="DNS解析"></a>DNS解析</h3><p>DNS将IP地址与域名进行映射,便于用户记忆和访问.</p>
<p>浏览器自身DNS-&gt;操作系统DNS-&gt;本地host文件-&gt;向域名服务器发送请求</p>
<p><strong>过程:</strong></p>
<ol>
<li><p>请求发起后浏览器首先会解析这个域名，首先查看本地硬盘的hosts文件，查看是否存在这个域名对应的规则，如果有的话，就直接使用hosts文件里面的IP地址</p>
</li>
<li><p>如果在本地的hosts文件中没有找到对应的IP地址，浏览器会发出一个DNS请求到本地DNS服务器，本地DNS服务器一般由ISP（网络接入服务商）提供。</p>
</li>
<li><p>查询你输入的网址的DNS请求到达本地DNS服务器后，本地DNS服务器会首先查询它的缓存记录，如果缓存命中则直接返回结果，此过程是递归方式进行查询，如果没有，本地服务器还需要向DNS根服务器进行查询。</p>
</li>
<li><p>根DNS服务器没有记录具体的域名和IP地址的对应关系，而是告诉本地DNS服务器可以到域服务器上继续查询,并给出域服务器的地址,这个过程是迭代的过程。</p>
</li>
</ol>
<blockquote>
<p>一、核心概念：什么是 OPTIONS 请求？<br><code>OPTIONS 是 HTTP 的一种请求方法，用于获取服务器支持的通信选项。</code></p>
<p>在浏览器 <strong>CORS（跨域资源共享）</strong> 场景中，OPTIONS 被用作 “预检请求”（Preflight Request）</p>
<p>预检请求的目的是为了确保实际请求对目标服务器是安全的，发送预请求可以得知服务器是否允许跨域请求以及运行那些字段和HTTP方法。<br>二、两种 CORS 请求类型</p>
<hr>
<table>
<thead>
<tr>
<th>类型</th>
<th>英文</th>
</tr>
</thead>
<tbody><tr>
<td><strong>简单请求</strong></td>
<td>Simple Request</td>
</tr>
<tr>
<td><strong>复杂请求</strong></td>
<td>Complex Request &#x2F; Preflighted Request</td>
</tr>
</tbody></table>
<h2 id="三、简单请求的判定标准（必须同时满足）"><a href="#三、简单请求的判定标准（必须同时满足）" class="headerlink" title="三、简单请求的判定标准（必须同时满足）"></a>三、简单请求的判定标准（<strong>必须同时满足</strong>）</h2><ol>
<li>方法限制</li>
</ol>
<p>只能是以下之一：</p>
<ul>
<li><p><code>GET</code></p>
</li>
<li><p><code>HEAD</code></p>
</li>
<li><p><code>POST</code></p>
<ol start="2">
<li>头部限制</li>
</ol>
</li>
</ul>
<p>只能包含 <strong>CORS 安全列出的头部</strong>：</p>
<ul>
<li><p><code>Accept</code></p>
</li>
<li><p><code>Accept-Language</code></p>
</li>
<li><p><code>Content-Language</code></p>
</li>
<li><p><code>Content-Type</code>（但值受限，见下）</p>
</li>
</ul>
<ol start="3">
<li>Content-Type 限制（如果是 POST）</li>
</ol>
<p>只能是：</p>
<ul>
<li><p><code>application/x-www-form-urlencoded</code></p>
</li>
<li><p><code>multipart/form-data</code></p>
</li>
<li><p><code>text/plain</code></p>
</li>
</ul>
<ol start="4">
<li>无自定义头部</li>
</ol>
<p>不能添加如 <code>X-Custom-Header</code>、<code>Authorization</code> 等自定义头部</p>
<ol start="5">
<li>无 ReadableStream 对象</li>
</ol>
<p>请求中不能使用 <code>ReadableStream</code></p>
<p>普通表单提交、简单的 GET 请求<br>四、复杂请求（触发预检的场景）</p>
<hr>
<p>只要 <strong>违反上述任一条件</strong>，就是复杂请求：</p>
<table>
<thead>
<tr>
<th>场景</th>
<th>示例</th>
</tr>
</thead>
<tbody><tr>
<td>使用非简单方法</td>
<td><code>PUT</code>、<code>DELETE</code>、<code>PATCH</code></td>
</tr>
<tr>
<td>发送 JSON 数据</td>
<td><code>Content-Type: application/json</code></td>
</tr>
<tr>
<td>携带自定义头部</td>
<td><code>Authorization: Bearer token</code></td>
</tr>
<tr>
<td>使用特殊头部</td>
<td><code>X-Requested-With</code> 等</td>
</tr>
</tbody></table>
</blockquote>
<h3 id="协商缓存"><a href="#协商缓存" class="headerlink" title="协商缓存"></a>协商缓存</h3><h4 id="强制缓存"><a href="#强制缓存" class="headerlink" title="强制缓存"></a>强制缓存</h4><p><strong>浏览器强制缓存服务端提供的资源</strong></p>
<p>通过配置响应头的<code>cache-control</code>字段的<code>max-age</code>和<code>Expires</code>字段来决定</p>
<table>
<thead>
<tr>
<th>头部</th>
<th>语法</th>
<th>特点</th>
<th>状态码</th>
</tr>
</thead>
<tbody><tr>
<td><strong>Expires</strong></td>
<td><code>Expires: Wed, 21 Oct 2026 07:28:00 GMT</code></td>
<td>HTTP&#x2F;1.0 产物，绝对时间，受本地时间影响</td>
<td>200 (from disk cache)</td>
</tr>
<tr>
<td><strong>Cache-Control</strong></td>
<td><code>Cache-Control: max-age=31536000</code></td>
<td>HTTP&#x2F;1.1 标准，相对时间（秒），更可靠</td>
<td>200 (from memory&#x2F;disk cache)</td>
</tr>
</tbody></table>
<h4 id="协商缓存-1"><a href="#协商缓存-1" class="headerlink" title="协商缓存"></a>协商缓存</h4><p>当服务端发现资源最后修改时间<code>Last-Modified</code>和<code>If-modified-since</code>值相等，代表资源从该时间后再未改变过。</p>
<p>服务端于是返回304（Not Modified）状态码，表示资源没有改变，并且响应体为空。浏览器拿到后，就知道原本可能过期的缓存其实还可以继续使用。</p>
<p>如果资源改变了，就会返回200，且响应体带上最新资源。Etag 的值没有规定一般是文件hash，当然你也可以设置版本号之类的去对比 </p>
<p>E-Tag一般规定为文件hash,也可以设置版本号。</p>
<table>
<thead>
<tr>
<th>头部</th>
<th>语法</th>
<th>验证方式</th>
<th>精度</th>
<th>状态码</th>
</tr>
</thead>
<tbody><tr>
<td><strong>Last-Modified</strong></td>
<td><code>Last-Modified: Tue, 15 Nov 2024 12:45:26 GMT</code></td>
<td>对比修改时间</td>
<td>秒级</td>
<td>304 &#x2F; 200</td>
</tr>
<tr>
<td><strong>ETag</strong></td>
<td><code>ETag: &quot;33a64df5-8d5c-4c7a-9c3f-2e1b8d6f5a4c&quot;</code></td>
<td>对比内容指纹（哈希）</td>
<td>毫秒级</td>
<td>304 &#x2F; 200</td>
</tr>
</tbody></table>
<h4 id="缓存规则"><a href="#缓存规则" class="headerlink" title="缓存规则"></a>缓存规则</h4><p>   先强制，后协商；<br>   强制不过期，直接本地拿；<br>   强制过期问服务器，ETag 优先来比对；<br>   ETag 相同 304，不同就下新资源。</p>
<h3 id="HTML渲染"><a href="#HTML渲染" class="headerlink" title="HTML渲染"></a>HTML渲染</h3><ol>
<li><p>HTML解析器把超文本和标签通过AST解析为DOM树</p>
</li>
<li><p>把CSS样式表转化为浏览器可以理解的styleSheet,属性值标准化,再处理集成和层叠,成为CSSOM的构建过程计算出DOM节点的样式</p>
</li>
</ol>
<h3 id="回流与重绘"><a href="#回流与重绘" class="headerlink" title="回流与重绘"></a>回流与重绘</h3><p>当<code>Render Tree</code>z中部分或全部元素的尺寸、结构或某些属性发生改变的时候，浏览器重新渲染部分或全部文档的过程称之为<strong>回流</strong>。</p>
<h4 id="触发回流的操作"><a href="#触发回流的操作" class="headerlink" title="触发回流的操作"></a>触发回流的操作</h4><ul>
<li><p>页面首次渲染</p>
</li>
<li><p>浏览器窗口大小发生改变</p>
</li>
<li><p>元素尺寸或位置发生改变</p>
</li>
<li><p>元素内容变化</p>
</li>
<li><p>元素字体大小变化</p>
</li>
<li><p>添加或删除可见的DOM元素</p>
</li>
<li><p>激活CSS伪类</p>
</li>
<li><p>查询某些属性或调用方法</p>
</li>
</ul>
<p>常用且会导致回流的属性和方法：</p>
<p>会导致回流的属性和方法</p>
<ul>
<li><p><code>clientWidth/Height/Top/Left</code>:元素的<strong>可视区域尺寸</strong></p>
</li>
<li><p><code>offsetWidth/Height/Top/Left</code>:元素的<strong>完整尺寸</strong></p>
</li>
<li><p><code>scrollWidth/Height/Top/Left</code>:元素的<strong>实际内容尺寸</strong>（包括由于溢出而不可见的部分）</p>
</li>
<li><p><code>scrollIntoView()</code>:将元素滚动到视口中使其可见</p>
</li>
<li><p><code>scrollIntoViewIfNeeded()</code>:非标准方法（仅WebKit&#x2F;Blink支持）</p>
</li>
<li><p><code>getComputedStyle()</code>:返回元素的所有CSS属性的计算值</p>
</li>
<li><p><code>getBoundingClientRect()</code>:返回元素的大小及其相对于视口的位置,返回一个包含<code>left</code>, <code>top</code>, <code>right</code>, <code>bottom</code>, <code>width</code>, <code>height</code>的DOMRect对象</p>
</li>
<li><p><code>scrollTo()</code>:将元素或窗口滚动到指定位置</p>
</li>
</ul>
<h4 id="触发重绘的操作"><a href="#触发重绘的操作" class="headerlink" title="触发重绘的操作"></a>触发重绘的操作</h4><p>当页面中元素样式的改变并不影响它在文档流中的位置时<code>color</code>,<code>background-color</code>,<code>visibility</code>等</p>
<h4 id="为什么transform-opacity不触发回流"><a href="#为什么transform-opacity不触发回流" class="headerlink" title="为什么transform/opacity不触发回流"></a>为什么<code>transform/opacity</code>不触发回流</h4><ul>
<li><p><strong>回流&#x2F;重排(Reflow)</strong>: 发生在布局阶段</p>
</li>
<li><p><strong>重绘(Repaint)</strong>: 发生在绘制阶段</p>
</li>
<li><p><strong>合成(Composite)</strong>: 发生在合成阶段</p>
</li>
</ul>
<p>浏览器会为这些属性创建独立的<strong>合成层</strong>：</p>
<ul>
<li><p>元素被提升到自己的图层（layer）</p>
</li>
<li><p>图层由GPU直接处理，不依赖CPU的布局计算</p>
</li>
<li><p>图层可以独立于其他图层进行变换</p>
</li>
</ul>
<p>浏览器自动创建合成层的情况：</p>
<ul>
<li><p>3D&#x2F;透视变换（perspective, transform3d）</p>
</li>
<li><p>使用will-change: transform&#x2F;opacity</p>
</li>
<li><p>视频、canvas、iframe元素</p>
</li>
<li><p>有3D上下文或加速2D上下文的canvas</p>
</li>
<li><p>具有opacity动画的过渡元素</p>
</li>
</ul>
<h4 id="如何避免回流"><a href="#如何避免回流" class="headerlink" title="如何避免回流"></a>如何避免回流</h4><p>1. <strong>开发阶段原则</strong></p>
<ul>
<li><p>优先使用CSS动画而非JavaScript动画</p>
</li>
<li><p>使用transform&#x2F;opacity实现视觉变化</p>
</li>
<li><p>避免直接操作内联样式</p>
</li>
<li><p>批量读取和写入DOM属性</p>
</li>
<li><p><code>requestAnimationFrame()</code>将DOM操作安排在浏览器重绘之前</p>
</li>
</ul>
<p>2. <strong>架构设计原则</strong></p>
<ul>
<li><p>实现虚拟列表&#x2F;无限滚动</p>
</li>
<li><p>采用组件懒加载</p>
</li>
<li><p>实现代码分割和按需加载</p>
</li>
</ul>
<h2 id="CDN"><a href="#CDN" class="headerlink" title="CDN"></a>CDN</h2><p>如果配置了CDN，DNS会将最终的域名解析权交给CNAME（别名指向）指向的CDN专用DNS服务器。</p>
<h2 id="浏览器跨域"><a href="#浏览器跨域" class="headerlink" title="浏览器跨域"></a>浏览器跨域</h2><h3 id="为什么会有跨域"><a href="#为什么会有跨域" class="headerlink" title="为什么会有跨域?"></a>为什么会有跨域?</h3><p><strong>同源策略:</strong> 相同网址的请求,其协议、域名、端口都应该相同，否则均属于跨域。</p>
<p>1. <strong>防止跨站脚本攻击（XSS）</strong></p>
<p>如果没有同源策略，恶意网站可以：</p>
<ul>
<li><p>通过iframe加载银行网站</p>
</li>
<li><p>使用JavaScript读取银行页面的DOM内容</p>
</li>
<li><p>窃取用户的登录凭证、账户信息</p>
</li>
</ul>
<p>2. <strong>防止跨站请求伪造（CSRF）</strong></p>
<p>同源策略限制了<strong>跨域读取响应</strong>，使得CSRF攻击虽然能发送请求，但攻击者无法读取响应内容。</p>
<p>3. <strong>保护用户会话状态</strong></p>
<ul>
<li><p>浏览器为每个源维护独立的cookie存储</p>
</li>
<li><p>防止恶意网站读取或修改其他网站的cookie</p>
</li>
<li><p>确保会话隔离，用户在不同网站的登录状态互不干扰</p>
</li>
</ul>
<p>4. <strong>防止恶意数据窃取</strong></p>
<ul>
<li><p>阻止恶意网站读取其他网站的本地存储（localStorage、sessionStorage）</p>
</li>
<li><p>防止IndexedDB等客户端数据库被跨域访问</p>
</li>
<li><p>保护用户的浏览历史、缓存等敏感信息</p>
</li>
</ul>
<h3 id="跨域解决方案"><a href="#跨域解决方案" class="headerlink" title="跨域解决方案"></a>跨域解决方案</h3><h4 id="前后端协商JSONP"><a href="#前后端协商JSONP" class="headerlink" title="前后端协商JSONP"></a>前后端协商JSONP</h4><p><strong>原理:</strong> Script标签的src不受同源策略的限制,可以跨域访问请求数据，但只能发送get请求</p>
<p><strong>缺点：</strong> 只能发送GET请求,不安全,不容易维护</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><code class="hljs html"><span class="hljs-tag">&lt;<span class="hljs-name">html</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">head</span>&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">meta</span> <span class="hljs-attr">title</span>=<span class="hljs-string">&quot;CORS&quot;</span>&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">meta</span> <span class="hljs-attr">charset</span>=<span class="hljs-string">&quot;utf-8&quot;</span>&gt;</span><br>    <span class="hljs-tag">&lt;/<span class="hljs-name">head</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">body</span>&gt;</span><br><br>    <span class="hljs-tag">&lt;/<span class="hljs-name">body</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">script</span>&gt;</span><span class="language-javascript"></span><br><span class="language-javascript">        <span class="hljs-keyword">const</span> <span class="hljs-title function_">jsonp</span> = (<span class="hljs-params">name</span>) =&gt;&#123;</span><br><span class="language-javascript">            <span class="hljs-keyword">let</span> script = <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">createElement</span>(<span class="hljs-string">&#x27;script&#x27;</span>);</span><br><span class="language-javascript">            script.<span class="hljs-property">src</span> = <span class="hljs-string">`http://localhost:3000/jsonp?callback=<span class="hljs-subst">$&#123;name&#125;</span>`</span>;</span><br><span class="language-javascript">            <span class="hljs-variable language_">document</span>.<span class="hljs-property">body</span>.<span class="hljs-title function_">appendChild</span>(script);</span><br><span class="language-javascript">            <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Promise</span>(<span class="hljs-function">(<span class="hljs-params">resolve</span>)=&gt;</span>&#123;</span><br><span class="language-javascript">                <span class="hljs-variable language_">window</span>[name] = <span class="hljs-function">(<span class="hljs-params">data</span>) =&gt;</span>&#123;</span><br><span class="language-javascript">                    <span class="hljs-title function_">resolve</span>(data)</span><br><span class="language-javascript">                &#125;</span><br><span class="language-javascript">            &#125;)</span><br><span class="language-javascript">        &#125;</span><br><span class="language-javascript">        <span class="hljs-title function_">jsonp</span>(<span class="hljs-string">`callback<span class="hljs-subst">$&#123;<span class="hljs-keyword">new</span> <span class="hljs-built_in">Date</span>().getTime()&#125;</span>`</span>).<span class="hljs-title function_">then</span>(<span class="hljs-function"><span class="hljs-params">data</span>=&gt;</span>&#123;</span><br><span class="language-javascript">            <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(data);</span><br><span class="language-javascript">        &#125;)</span><br><span class="language-javascript">    </span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">html</span>&gt;</span><br></code></pre></td></tr></table></figure>

<p><strong>后端:</strong></p>
<figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><code class="hljs ts"><span class="hljs-keyword">import</span> express <span class="hljs-keyword">from</span><span class="hljs-string">&#x27;express&#x27;</span><br><br><span class="hljs-keyword">const</span> app = <span class="hljs-title function_">express</span>()<br><br>app.<span class="hljs-title function_">get</span>(<span class="hljs-string">&#x27;/jsonp&#x27;</span>,<span class="hljs-function">(<span class="hljs-params">req,res</span>)=&gt;</span>&#123;<br>    <span class="hljs-keyword">const</span> &#123;callback&#125; = req.<span class="hljs-property">query</span><br><br>    res.<span class="hljs-title function_">send</span>(<span class="hljs-string">`<span class="hljs-subst">$&#123;callback&#125;</span>(<span class="hljs-subst">$&#123;<span class="hljs-built_in">JSON</span>.stringify(&#123;message:<span class="hljs-string">&#x27;Hello, JSONP!&#x27;</span>&#125;)&#125;</span>)`</span>)<br><br>&#125;)<br><br>app.<span class="hljs-title function_">listen</span>(<span class="hljs-number">3000</span>,<span class="hljs-function">()=&gt;</span>&#123;<br>    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">&#x27;JSONP server running on http://localhost:3000&#x27;</span>)&#125;)<br><br></code></pre></td></tr></table></figure>



<h4 id="前端代理"><a href="#前端代理" class="headerlink" title="前端代理"></a>前端代理</h4><p>使用Vite,Webpac配置Proxy</p>
<figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><code class="hljs ts"><span class="hljs-comment">// vite.config.ts</span><br><br><br><span class="hljs-keyword">import</span> &#123;defineConfig&#125; <span class="hljs-keyword">from</span> <span class="hljs-string">&#x27;vite&#x27;</span><br><br><br><span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> <span class="hljs-title function_">defineConfig</span>(&#123;<br>    <span class="hljs-attr">server</span>:&#123;<br>    <span class="hljs-attr">proxy</span>:&#123;<br>    <span class="hljs-string">&#x27;/api&#x27;</span>:&#123;<br>        <span class="hljs-attr">target</span>:<span class="hljs-string">&#x27;http://localhost:3000&#x27;</span>,<br>        <span class="hljs-attr">changeOrigin</span>:<span class="hljs-literal">true</span>,<br>        <span class="hljs-comment">// rewrite...</span><br>&#125;<br>&#125;<br>&#125;<br>&#125;)<br></code></pre></td></tr></table></figure>



<h4 id="后端配置请求头"><a href="#后端配置请求头" class="headerlink" title="后端配置请求头"></a>后端配置请求头</h4><ol>
<li><p><strong>Access-Control-Allow-Origin</strong>：控制哪些源可以访问</p>
</li>
<li><p><strong>Access-Control-Allow-Credentials</strong>：是否允许携带凭证</p>
</li>
<li><p><strong>Access-Control-Allow-Methods</strong>：允许的HTTP方法</p>
</li>
<li><p><strong>Access-Control-Allow-Headers</strong>：允许的请求头</p>
</li>
</ol>
<figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs ts"><br>app.<span class="hljs-title function_">get</span>(<span class="hljs-string">&#x27;api/json&#x27;</span>,<span class="hljs-function">(<span class="hljs-params">res,req</span>)=&gt;</span>&#123;<br>    res.<span class="hljs-title function_">setHeader</span>(<span class="hljs-string">&#x27;Access-Control-Allow-Origin&#x27;</span>,<span class="hljs-string">&quot;*&quot;</span>);<br>&#125;)<br></code></pre></td></tr></table></figure>

<h4 id="Nginx"><a href="#Nginx" class="headerlink" title="Nginx"></a>Nginx</h4><p>配置Nginx</p>
<figure class="highlight nginx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs nginx"><span class="hljs-section">location</span> /api &#123;<br>    <span class="hljs-attribute">proxy_pass</span> http://127.0.0.1:3000;<br>&#125;<br></code></pre></td></tr></table></figure>

<h2 id="AJAX"><a href="#AJAX" class="headerlink" title="AJAX"></a>AJAX</h2><p>Ajax（Asynchronous JavaScript And XML）即异步 JavaScript 和 XML，是一组用于在网页上进行异步数据交换的Web开发技术，可以在不刷新整个页面的情况下向服务器发起请求并获取数据，然后将数据插入到网页中的某个位置。这种技术能够实现增量式更新页面，提高用户交互体验，减少响应时间和带宽的消耗。</p>
<p>使用 Ajax 技术，可以通过 JavaScript 和 XMLHttpRequest 对象来向服务器获取数据。在Ajax请求的过程中，可以通过定义回调函数来对请求的结果进行处理，回调函数会在请求完成后执行，通过这种方式可以更新页面内容或者响应用户操作。</p>
<h3 id="GET请求"><a href="#GET请求" class="headerlink" title="GET请求"></a>GET请求</h3><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><code class="hljs html"><span class="hljs-tag">&lt;<span class="hljs-name">html</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">head</span>&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">meta</span> <span class="hljs-attr">title</span>=<span class="hljs-string">&quot;CORS&quot;</span>&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">meta</span> <span class="hljs-attr">charset</span>=<span class="hljs-string">&quot;utf-8&quot;</span>&gt;</span><br>    <span class="hljs-tag">&lt;/<span class="hljs-name">head</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">body</span>&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">button</span> <span class="hljs-attr">id</span>=<span class="hljs-string">&quot;btn&quot;</span>&gt;</span>AJAX GET<span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">p</span> <span class="hljs-attr">id</span>=<span class="hljs-string">&quot;updatedP&quot;</span>&gt;</span> It should update.<span class="hljs-tag">&lt;/<span class="hljs-name">p</span>&gt;</span><br>    <span class="hljs-tag">&lt;/<span class="hljs-name">body</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">script</span>&gt;</span><span class="language-javascript"></span><br><span class="language-javascript">        <span class="hljs-keyword">const</span> btn = <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">getElementById</span>(<span class="hljs-string">&#x27;btn&#x27;</span>);</span><br><span class="language-javascript">        <span class="hljs-keyword">const</span> <span class="hljs-title function_">sendAjax</span> = (<span class="hljs-params"></span>) =&gt;&#123;</span><br><span class="language-javascript">            <span class="hljs-keyword">const</span> xhr = <span class="hljs-keyword">new</span> <span class="hljs-title class_">XMLHttpRequest</span>();</span><br><span class="language-javascript">            xhr.<span class="hljs-title function_">open</span>(<span class="hljs-string">&#x27;GET&#x27;</span>,<span class="hljs-string">&#x27;http://localhost:3000/api/hello&#x27;</span>,<span class="hljs-literal">true</span>);</span><br><span class="language-javascript">            xhr.<span class="hljs-property">onreadystatechange</span> = <span class="hljs-function">() =&gt;</span> &#123;</span><br><span class="language-javascript">                <span class="hljs-keyword">if</span>(xhr.<span class="hljs-property">readyState</span> === <span class="hljs-number">4</span> &amp;&amp; xhr.<span class="hljs-property">status</span> === <span class="hljs-number">200</span>)&#123;</span><br><span class="language-javascript">                    <span class="hljs-keyword">const</span> res = xhr.<span class="hljs-property">responseText</span>;</span><br><span class="language-javascript">                    <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">getElementById</span>(<span class="hljs-string">&#x27;updatedP&#x27;</span>).<span class="hljs-property">innerText</span> = res;</span><br><span class="language-javascript">                    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(res);</span><br><span class="language-javascript">                &#125;</span><br><span class="language-javascript">            &#125;</span><br><span class="language-javascript">            xhr.<span class="hljs-title function_">send</span>(<span class="hljs-literal">null</span>);</span><br><span class="language-javascript">        &#125;</span><br><span class="language-javascript">        btn.<span class="hljs-title function_">addEventListener</span>(<span class="hljs-string">&#x27;click&#x27;</span>,<span class="hljs-function">()=&gt;</span>&#123;</span><br><span class="language-javascript">            <span class="hljs-title function_">sendAjax</span>();</span><br><span class="language-javascript">        &#125;);</span><br><span class="language-javascript"></span><br><span class="language-javascript"></span><br><span class="language-javascript">    </span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">html</span>&gt;</span><br></code></pre></td></tr></table></figure>

<h3 id="发送POST请求"><a href="#发送POST请求" class="headerlink" title="发送POST请求"></a>发送POST请求</h3><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-keyword">const</span> xhr = <span class="hljs-keyword">new</span> <span class="hljs-title class_">XMLHttpRequest</span>();<br>xhr.<span class="hljs-title function_">open</span>(<span class="hljs-string">&#x27;POST&#x27;</span>, <span class="hljs-string">&#x27;http://localhost:3000/api/post&#x27;</span>)<br>xhr.<span class="hljs-title function_">setRequestHeader</span>(<span class="hljs-string">&#x27;Content-Type&#x27;</span>, <span class="hljs-string">&#x27;application/json&#x27;</span>);<br>xhr.<span class="hljs-property">onload</span> = <span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) &#123;<br>  <span class="hljs-keyword">if</span> (xhr.<span class="hljs-property">status</span> === <span class="hljs-number">200</span>) &#123;<br>        <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">querySelector</span>(<span class="hljs-string">&#x27;#result&#x27;</span>).<span class="hljs-property">innerText</span> = xhr.<span class="hljs-property">responseText</span>;<br>    &#125;<br>    <span class="hljs-keyword">else</span> &#123;<br>       <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">&#x27;Request failed.  Returned status of &#x27;</span> + xhr.<span class="hljs-property">status</span>);<br>   &#125;<br>&#125;;<br>xhr.<span class="hljs-title function_">send</span>(<span class="hljs-title class_">JSON</span>.<span class="hljs-title function_">stringify</span>(&#123;<span class="hljs-attr">name</span>: <span class="hljs-string">&#x27;zhangsan&#x27;</span>, <span class="hljs-attr">age</span>: <span class="hljs-number">18</span>&#125;));<br><br></code></pre></td></tr></table></figure>

<h3 id="POST-请求-application-x-www-form-urlencoded"><a href="#POST-请求-application-x-www-form-urlencoded" class="headerlink" title="POST 请求 application&#x2F;x-www-form-urlencoded"></a>POST 请求 application&#x2F;x-www-form-urlencoded</h3><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-keyword">const</span> xhr = <span class="hljs-keyword">new</span> <span class="hljs-title class_">XMLHttpRequest</span>();<br>xhr.<span class="hljs-title function_">open</span>(<span class="hljs-string">&#x27;POST&#x27;</span>, <span class="hljs-string">&#x27;http://localhost:3000/api/post&#x27;</span>)<br>xhr.<span class="hljs-title function_">setRequestHeader</span>(<span class="hljs-string">&#x27;Content-Type&#x27;</span>, <span class="hljs-string">&#x27;application/x-www-form-urlencoded&#x27;</span>);<br>xhr.<span class="hljs-property">onload</span> = <span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) &#123;<br>  <span class="hljs-keyword">if</span> (xhr.<span class="hljs-property">status</span> === <span class="hljs-number">200</span>) &#123;<br>        <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">querySelector</span>(<span class="hljs-string">&#x27;#result&#x27;</span>).<span class="hljs-property">innerText</span> = xhr.<span class="hljs-property">responseText</span>;<br>    &#125;<br>    <span class="hljs-keyword">else</span> &#123;<br>       <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">&#x27;Request failed.  Returned status of &#x27;</span> + xhr.<span class="hljs-property">status</span>);<br>   &#125;<br>&#125;;<br>xhr.<span class="hljs-title function_">send</span>(<span class="hljs-string">&#x27;name=zhangsan&amp;age=18&#x27;</span>);<br><br></code></pre></td></tr></table></figure>

<h3 id="中断请求-和-设置超时时间"><a href="#中断请求-和-设置超时时间" class="headerlink" title="中断请求 和 设置超时时间"></a>中断请求 和 设置超时时间</h3><p>中断请求只需要调用 <code>xhr.abort()</code>; 即可并且会有一个中断的回调。</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs js">xhr.<span class="hljs-title function_">addEventListener</span>(<span class="hljs-string">&#x27;abort&#x27;</span>, <span class="hljs-keyword">function</span> (<span class="hljs-params">event</span>) &#123; <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">&#x27;我被中断了&#x27;</span>); &#125;);<br></code></pre></td></tr></table></figure>

<p>超时时间可以设置timeout 参数</p>
<p>xhr.timeout &#x3D; 3000;</p>
<p>同样有一个超时回调</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs js">xhr.<span class="hljs-title function_">addEventListener</span>(<span class="hljs-string">&#x27;timeout&#x27;</span>, <span class="hljs-keyword">function</span> (<span class="hljs-params">event</span>) &#123; <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">&#x27;超时啦&#x27;</span>); &#125;);<br></code></pre></td></tr></table></figure>

<h3 id="获取进度"><a href="#获取进度" class="headerlink" title="获取进度"></a>获取进度</h3><p>可以监听 progress</p>
<p>在监听器中，我们通过 event.loaded 和 event.total 属性获取已上传数据量和总数据量，并计算上传进度，最后将进度显示在页面上</p>
<h2 id="Fetch-API"><a href="#Fetch-API" class="headerlink" title="Fetch API"></a>Fetch API</h2><p>为什么使用<code>Fetch</code>:</p>
<ul>
<li><p>代码更简单</p>
</li>
<li><p>可维护性好</p>
</li>
</ul>
<h3 id="GET请求-1"><a href="#GET请求-1" class="headerlink" title="GET请求"></a>GET请求</h3><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><code class="hljs html"><span class="hljs-tag">&lt;<span class="hljs-name">html</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">head</span>&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">meta</span> <span class="hljs-attr">title</span>=<span class="hljs-string">&quot;CORS&quot;</span>&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">meta</span> <span class="hljs-attr">charset</span>=<span class="hljs-string">&quot;utf-8&quot;</span>&gt;</span><br>    <span class="hljs-tag">&lt;/<span class="hljs-name">head</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">body</span>&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">button</span> <span class="hljs-attr">id</span>=<span class="hljs-string">&quot;btn&quot;</span>&gt;</span>AJAX GET<span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">p</span> <span class="hljs-attr">id</span>=<span class="hljs-string">&quot;updatedP&quot;</span>&gt;</span> It should update.<span class="hljs-tag">&lt;/<span class="hljs-name">p</span>&gt;</span><br>    <span class="hljs-tag">&lt;/<span class="hljs-name">body</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">script</span>&gt;</span><span class="language-javascript"></span><br><span class="language-javascript">        <span class="hljs-keyword">const</span> btn = <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">getElementById</span>(<span class="hljs-string">&#x27;btn&#x27;</span>);</span><br><span class="language-javascript">        <span class="hljs-keyword">const</span> <span class="hljs-title function_">sendfetch</span> = (<span class="hljs-params"></span>) =&gt;&#123;</span><br><span class="language-javascript">            <span class="hljs-title function_">fetch</span>(<span class="hljs-string">&#x27;http://localhost:3000/api/hello&#x27;</span>)</span><br><span class="language-javascript">     <span class="hljs-comment">//指定返回方式</span></span><br><span class="language-javascript">       .<span class="hljs-title function_">then</span>(<span class="hljs-function"><span class="hljs-params">res</span>=&gt;</span>res.<span class="hljs-title function_">text</span>())</span><br><span class="language-javascript">            .<span class="hljs-title function_">then</span>(<span class="hljs-function"><span class="hljs-params">data</span>=&gt;</span>&#123;</span><br><span class="language-javascript">                <span class="hljs-keyword">const</span> p = <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">getElementById</span>(<span class="hljs-string">&#x27;updatedP&#x27;</span>);</span><br><span class="language-javascript">                p.<span class="hljs-property">innerText</span> = data;</span><br><span class="language-javascript">            &#125;)</span><br><span class="language-javascript">        &#125;</span><br><span class="language-javascript">        btn.<span class="hljs-title function_">addEventListener</span>(<span class="hljs-string">&#x27;click&#x27;</span>,<span class="hljs-function">()=&gt;</span>&#123;</span><br><span class="language-javascript">            <span class="hljs-title function_">sendfetch</span>();</span><br><span class="language-javascript">        &#125;);</span><br><span class="language-javascript"></span><br><span class="language-javascript"></span><br><span class="language-javascript">    </span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">html</span>&gt;</span><br></code></pre></td></tr></table></figure>

<h3 id="POST请求"><a href="#POST请求" class="headerlink" title="POST请求"></a>POST请求</h3><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><code class="hljs js"><br><span class="hljs-title function_">fetch</span>(<span class="hljs-string">&#x27;http://localhost:3000/api/post&#x27;</span>,&#123;<br>    <span class="hljs-attr">method</span>:<span class="hljs-string">&#x27;POST&#x27;</span>,<br>    <span class="hljs-attr">headers</span>:&#123;<br>        <span class="hljs-string">&#x27;Content-Type&#x27;</span>:<span class="hljs-string">&#x27;application/json&#x27;</span><br>    &#125;,<br>    <span class="hljs-attr">body</span>:<span class="hljs-title class_">JSON</span>.<span class="hljs-title function_">stringify</span>(&#123;<br>        <span class="hljs-attr">name</span>:<span class="hljs-string">&#x27;zhangsan&#x27;</span>,<br>        <span class="hljs-attr">age</span>:<span class="hljs-number">18</span><br>    &#125;)<br>&#125;).<span class="hljs-title function_">then</span>(<span class="hljs-function"><span class="hljs-params">res</span> =&gt;</span> &#123;<br>    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(res);<br>    <span class="hljs-keyword">return</span> res.<span class="hljs-title function_">json</span>()<br>&#125;).<span class="hljs-title function_">then</span>(<span class="hljs-function"><span class="hljs-params">res</span> =&gt;</span> &#123;<br>    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(res);<br>&#125;)<br><br></code></pre></td></tr></table></figure>

<h3 id="中断请求"><a href="#中断请求" class="headerlink" title="中断请求"></a>中断请求</h3><p>使用 <code>AbortController</code> 的 <code>abort</code>方法中断</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-keyword">const</span> abort = <span class="hljs-keyword">new</span> <span class="hljs-title class_">AbortController</span>()<br><span class="hljs-title function_">fetch</span>(<span class="hljs-string">&#x27;http://localhost:3000/api/post&#x27;</span>,&#123;<br>    <span class="hljs-attr">method</span>:<span class="hljs-string">&#x27;POST&#x27;</span>,<br>    <span class="hljs-attr">headers</span>:&#123;<br>        <span class="hljs-string">&#x27;Content-Type&#x27;</span>:<span class="hljs-string">&#x27;application/json&#x27;</span><br>    &#125;,<br>    <span class="hljs-attr">signal</span>:abort.<span class="hljs-property">signal</span>,<br>    <span class="hljs-attr">body</span>:<span class="hljs-title class_">JSON</span>.<span class="hljs-title function_">stringify</span>(&#123;<br>        <span class="hljs-attr">name</span>:<span class="hljs-string">&#x27;zhangsan&#x27;</span>,<br>        <span class="hljs-attr">age</span>:<span class="hljs-number">18</span><br>    &#125;)<br>&#125;).<span class="hljs-title function_">then</span>(<span class="hljs-function"><span class="hljs-params">res</span> =&gt;</span> &#123;<br>    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(res);<br>    <span class="hljs-keyword">return</span> res.<span class="hljs-title function_">json</span>()<br>&#125;).<span class="hljs-title function_">then</span>(<span class="hljs-function"><span class="hljs-params">res</span> =&gt;</span> &#123;<br>    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(res);<br>&#125;)<br><br><span class="hljs-variable language_">document</span>.<span class="hljs-title function_">querySelector</span>(<span class="hljs-string">&#x27;#stop&#x27;</span>).<span class="hljs-title function_">addEventListener</span>(<span class="hljs-string">&#x27;click&#x27;</span>, <span class="hljs-function">() =&gt;</span> &#123;<br>        <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">&#x27;stop&#x27;</span>);<br>        abort.<span class="hljs-title function_">abort</span>()<br>&#125;)<br><br></code></pre></td></tr></table></figure>

<h3 id="获取进度-1"><a href="#获取进度-1" class="headerlink" title="获取进度"></a>获取进度</h3><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><code class="hljs js"><br><span class="hljs-keyword">const</span> btn = <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">querySelector</span>(<span class="hljs-string">&#x27;#send&#x27;</span>)<br><span class="hljs-keyword">const</span> <span class="hljs-title function_">sendFetch</span> = <span class="hljs-keyword">async</span> (<span class="hljs-params"></span>) =&gt; &#123;<br>    <span class="hljs-keyword">const</span> data = <span class="hljs-keyword">await</span> <span class="hljs-title function_">fetch</span>(<span class="hljs-string">&#x27;http://localhost:3000/api/txt&#x27;</span>,&#123;<br>        <span class="hljs-attr">signal</span>:abort.<span class="hljs-property">signal</span><br>    &#125;)<br>    <span class="hljs-comment">//fetch 实现进度条</span><br>    <span class="hljs-keyword">const</span> response = data.<span class="hljs-title function_">clone</span>()<br>    <span class="hljs-keyword">const</span> reader = data.<span class="hljs-property">body</span>.<span class="hljs-title function_">getReader</span>()<br>    <span class="hljs-keyword">const</span> contentLength = data.<span class="hljs-property">headers</span>.<span class="hljs-title function_">get</span>(<span class="hljs-string">&#x27;Content-Length&#x27;</span>)<br>    <span class="hljs-keyword">let</span> loaded = <span class="hljs-number">0</span><br>    <span class="hljs-keyword">while</span> (<span class="hljs-literal">true</span>) &#123;<br>        <span class="hljs-keyword">const</span> &#123; done, value &#125; = <span class="hljs-keyword">await</span> reader.<span class="hljs-title function_">read</span>()<br>        <span class="hljs-keyword">if</span> (done) &#123;<br>            <span class="hljs-keyword">break</span><br>        &#125;<br>        loaded += value?.<span class="hljs-property">length</span> || <span class="hljs-number">0</span>;<br>        <span class="hljs-keyword">const</span> progress = <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">querySelector</span>(<span class="hljs-string">&#x27;#progress&#x27;</span>)<br>        progress.<span class="hljs-property">innerHTML</span> = (loaded / contentLength * <span class="hljs-number">100</span>).<span class="hljs-title function_">toFixed</span>(<span class="hljs-number">2</span>) + <span class="hljs-string">&#x27;%&#x27;</span><br>    &#125;<br>    <span class="hljs-keyword">const</span> text = <span class="hljs-keyword">await</span> response.<span class="hljs-title function_">text</span>()<br>    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(text);<br>&#125;<br>btn.<span class="hljs-title function_">addEventListener</span>(<span class="hljs-string">&#x27;click&#x27;</span>, sendFetch)<br><br></code></pre></td></tr></table></figure>

<h3 id="携带Cookie"><a href="#携带Cookie" class="headerlink" title="携带Cookie"></a>携带Cookie</h3><p>设置 <code>credentials:&#39;include&#39;</code></p>
<h2 id="SSE"><a href="#SSE" class="headerlink" title="SSE"></a>SSE</h2><h3 id="概述"><a href="#概述" class="headerlink" title="概述"></a>概述</h3><p>SSE（Server-Sent Events）是一种用于实现服务器主动向客户端推送数据的技术，也被称为“事件流”（Event Stream）。它基于 HTTP 协议，利用了其长连接特性，在客户端与服务器之间建立一条持久化连接，并通过这条连接实现服务器向客户端的实时数据推送。</p>
<h3 id="SSE与WS的区别"><a href="#SSE与WS的区别" class="headerlink" title="SSE与WS的区别"></a>SSE与WS的区别</h3><p>SSE（Server-Sent Events）和 WebSocket 都是实现服务器向客户端实时推送数据的技术，但它们在某些方面还是有一定的区别。</p>
<ol>
<li>技术实现</li>
</ol>
<p>SSE 基于 HTTP 协议，利用了其长连接特性，通过浏览器向服务器发送一个 HTTP 请求，建立一条持久化的连接。而 WebSocket 则是通过特殊的升级协议（HTTP&#x2F;1.1 Upgrade 或者 HTTP&#x2F;2）建立新的 TCP 连接，与传统 HTTP 连接不同。</p>
<ol start="2">
<li>数据格式</li>
</ol>
<p>SSE 可以传输文本和二进制格式的数据，但只支持单向数据流，即只能由服务器向客户端推送数据。WebSocket 支持双向数据流，客户端和服务器可以互相发送消息，并且没有消息大小限制。</p>
<ol start="3">
<li>连接状态</li>
</ol>
<p>SSE 的连接状态仅有三种：已连接、连接中、已断开。连接状态是由浏览器自动维护的，客户端无法手动关闭或重新打开连接。而 WebSocket 连接的状态更灵活，可以手动打开、关闭、重连等。</p>
<ol start="4">
<li>兼容性</li>
</ol>
<p>SSE 是标准的 Web API，可以在大部分现代浏览器和移动设备上使用。但如果需要兼容老版本的浏览器（如 IE6&#x2F;7&#x2F;8），则需要使用 polyfill 库进行兼容。而 WebSocket 在一些老版本 Android 手机上可能存在兼容性问题，需要使用一些特殊的 API 进行处理。</p>
<ol start="5">
<li>安全性</li>
</ol>
<p>SSE 的实现比较简单，都是基于 HTTP 协议的，与普通的 Web 应用没有太大差异，因此风险相对较低。WebSocket 则需要通过额外的安全措施（如 SSL&#x2F;TLS 加密）来确保数据传输的安全性，避免被窃听和篡改，否则可能会带来安全隐患。</p>
<p>总体来说，SSE 和 WebSocket 都有各自的优缺点，适用于不同的场景和需求。如果只需要服务器向客户端单向推送数据，并且应用在前端的浏览器环境中，则 SSE 是一个更加轻量级、易于实现和维护的选择。而如果需要双向传输数据、支持自定义协议、或者在更加复杂的网络环境中应用，则 WebSocket 可能更加适合。</p>
<h3 id="API"><a href="#API" class="headerlink" title="API"></a>API</h3><h4 id="EventSource构造函数"><a href="#EventSource构造函数" class="headerlink" title="EventSource构造函数"></a>EventSource构造函数</h4><p><code>EventSource</code> 的构造函数接收一个 URL 参数，通过该 URL 可以建立起与服务器的连接，并开始接收服务器发送的数据。</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-keyword">const</span> eventSource = <span class="hljs-keyword">new</span> <span class="hljs-title class_">EventSource</span>(<span class="hljs-string">&#x27;/my-server&#x27;</span>);<br></code></pre></td></tr></table></figure>

<h4 id="EventSource-readyState-属性"><a href="#EventSource-readyState-属性" class="headerlink" title="EventSource.readyState 属性"></a>EventSource.readyState 属性</h4><p><code>readyState</code> 属性表示当前 <code>EventSource</code> 对象的状态，它是一个只读属性，它的值有以下几个：</p>
<ul>
<li><code>CONNECTING</code>：表示正在和服务器建立连接。</li>
<li><code>OPEN</code>：表示已经建立连接，正在接收服务器发送的数据。</li>
<li><code>CLOSED</code>：表示连接已经被关闭，无法再接收服务器发送的数据。</li>
</ul>
<h4 id="EventSource-close-方法"><a href="#EventSource-close-方法" class="headerlink" title="EventSource.close() 方法"></a>EventSource.close() 方法</h4><p><code>close()</code> 方法用于关闭 <code>EventSource</code> 对象与服务器的连接，停止接收服务器发送的数据。</p>
<h4 id="EventSource-onopen-事件"><a href="#EventSource-onopen-事件" class="headerlink" title="EventSource.onopen 事件"></a>EventSource.onopen 事件</h4><p><code>onopen</code> 事件表示 <code>EventSource</code> 对象已经和服务器建立了连接，并开始接收来自服务器的数据。当 <code>EventSource</code> 对象建立连接时，触发该事件。</p>
<p><code>eventSource.onopen = function(event) &#123;   console.log(&#39;连接成功！&#39;, event); &#125;;</code></p>
<h4 id="EventSource-onerror-事件"><a href="#EventSource-onerror-事件" class="headerlink" title="EventSource.onerror 事件"></a>EventSource.onerror 事件</h4><p><code>onerror</code> 事件表示在建立连接或接收服务器数据时发生了错误。当出现错误时，触发该事件。</p>
<p><code>eventSource.onerror = function(event) &#123;   console.log(&#39;发生错误：&#39;, event); &#125;;</code></p>
<h4 id="EventSource-onmessage-事件"><a href="#EventSource-onmessage-事件" class="headerlink" title="EventSource.onmessage 事件"></a>EventSource.onmessage 事件</h4><p><code>onmessage</code> 事件表示已经接收到服务器发送的数据，当接收到数据时，触发该事件。</p>
<p><code>eventSource.onmessage = function(event) &#123;   console.log(&#39;接收到数据：&#39;, event); &#125;;</code></p>
<p>以上就是 <code>EventSource</code> 对象的常用 API 介绍，需要注意的是，在使用 <code>EventSource</code> 对象的过程中，如果服务器没有正确地设置响应头信息（如：<code>Content-Type: text/event-stream</code>），可能会导致 <code>EventSource</code> 对象无法接收到服务器发送的数据。</p>

                
              </div>
            
            <hr>
            <div>
              <div class="post-metas my-3">
  
    <div class="post-meta mr-3 d-flex align-items-center">
      <i class="iconfont icon-category"></i>
      

<span class="category-chains">
  
  
    
      <span class="category-chain">
        
  <a href="/categories/network/" class="category-chain-item">network</a>
  
  

      </span>
    
  
</span>

    </div>
  
  
    <div class="post-meta">
      <i class="iconfont icon-tags"></i>
      
        <a href="/tags/network/" class="print-no-link">#network</a>
      
    </div>
  
</div>


              
  

  <div class="license-box my-3">
    <div class="license-title">
      <div>计算机网络沉淀心得</div>
      <div>http://arkpln.github.io/3712793328.html</div>
    </div>
    <div class="license-meta">
      
        <div class="license-meta-item">
          <div>Author</div>
          <div>FangZhou</div>
        </div>
      
      
        <div class="license-meta-item license-meta-date">
          <div>Posted on</div>
          <div>January 26, 2026</div>
        </div>
      
      
      
        <div class="license-meta-item">
          <div>Licensed under</div>
          <div>
            
              
              
                <a class="print-no-link" target="_blank" href="https://creativecommons.org/licenses/by/4.0/" rel="external nofollow noopener noreferrer">
                  <span class="hint--top hint--rounded" aria-label="BY - Attribution">
                    <i class="iconfont icon-cc-by"></i>
                  </span>
                </a>
              
            
          </div>
        </div>
      
    </div>
    <div class="license-icon iconfont"></div>
  </div>

<div style="width:100%;display:flex;justify-content:center;margin-bottom:1.5rem"><ins class="adsbygoogle" style="display:flex;justify-content:center;max-width:845px;width:100%;height:90px" data-ad-client="ca-pub-3240358922862141" data-ad-slot="6522434837"></ins><script> (adsbygoogle = window.adsbygoogle || []).push({}); </script></div>

              
                <div class="post-prevnext my-3">
                  <article class="post-prev col-6">
                    
                    
                      <a href="/626095156.html" title="Leetcode Hot100刷题记">
                        <i class="iconfont icon-arrowleft"></i>
                        <span class="hidden-mobile">Leetcode Hot100刷题记</span>
                        <span class="visible-mobile">Previous</span>
                      </a>
                    
                  </article>
                  <article class="post-next col-6">
                    
                    
                      <a href="/2544566248.html" title="软件工程复习笔记">
                        <span class="hidden-mobile">软件工程复习笔记</span>
                        <span class="visible-mobile">Next</span>
                        <i class="iconfont icon-arrowright"></i>
                      </a>
                    
                  </article>
                </div>
              
            </div>

            
  
  
    <article id="comments" lazyload>
      
  <div id="valine"></div>
  <script type="text/javascript">
    Fluid.utils.loadComments('#valine', function() {
      Fluid.utils.createScript('https://lib.baomitu.com/valine/1.5.1/Valine.min.js', function() {
        var options = Object.assign(
          {"appId":"mEwkD7geCX7RWNO8srhDE2oP-gzGzoHsz","appKey":"4EF76hyiVA1QILHZThVbfoat","path":"window.location.pathname","placeholder":null,"avatar":"retro","meta":["nick","mail","link"],"requiredFields":[],"pageSize":10,"lang":"zh-CN","highlight":false,"recordIP":false,"serverURLs":"","emojiCDN":null,"emojiMaps":null,"enableQQ":false,"el":"#vcomments"},
          {
            el: "#valine",
            path: window.location.pathname
          }
        )
        new Valine(options);
        Fluid.utils.waitElementVisible('#valine .vcontent', () => {
          var imgSelector = '#valine .vcontent img:not(.vemoji)';
          Fluid.plugins.imageCaption(imgSelector);
          Fluid.plugins.fancyBox(imgSelector);
        })
      });
    });
  </script>
  <noscript>Please enable JavaScript to view the comments</noscript>


    </article>
  


          </article>
        </div>
      </div>
    </div>

    <div class="side-col d-none d-lg-block col-lg-2">
      
  <aside class="sidebar" style="margin-left: -1rem">
    <div id="toc">
  <p class="toc-header">
    <i class="iconfont icon-list"></i>
    <span>Table of Contents</span>
  </p>
  <div class="toc-body" id="toc-body"></div>
</div>



  </aside>


    </div>
  </div>
</div>





  



  



  



  



  







    

    
      <a id="scroll-top-button" aria-label="TOP" href="#" role="button">
        <i class="iconfont icon-arrowup" aria-hidden="true"></i>
      </a>
    

    
      <div class="modal fade" id="modalSearch" tabindex="-1" role="dialog" aria-labelledby="ModalLabel" aria-hidden="true">
  <div class="modal-dialog modal-dialog-scrollable modal-lg" role="document">
    <div class="modal-content">
      <div class="modal-header text-center">
        <h4 class="modal-title w-100 font-weight-bold">Search</h4>
        <button type="button" id="local-search-close" class="close" data-dismiss="modal" aria-label="Close">
          <span aria-hidden="true">&times;</span>
        </button>
      </div>
      <div class="modal-body mx-3">
        <div class="md-form mb-5">
          <input type="text" id="local-search-input" class="form-control validate">
          <label data-error="x" data-success="v" for="local-search-input">Keyword</label>
        </div>
        <div class="list-group" id="local-search-result"></div>
      </div>
    </div>
  </div>
</div>

    

    
  </main>

  <footer>
    <div class="footer-inner">
  
    <div class="footer-content">
       <a href="https://hexo.io" target="_blank" rel="external nofollow noopener noreferrer"><span>Hexo</span></a> <i class="iconfont icon-love"></i> <a href="https://github.com/fluid-dev/hexo-theme-fluid" target="_blank" rel="external nofollow noopener noreferrer"><span>Fluid</span></a>
    </div>
  
  
    <div class="statistics">
  
  

  
    
      <span id="leancloud-site-pv-container" style="display: none">
        总访问量 
        <span id="leancloud-site-pv"></span>
         次
      </span>
    
    
      <span id="leancloud-site-uv-container" style="display: none">
        总访客数 
        <span id="leancloud-site-uv"></span>
         人
      </span>
    
    

  

</div>

  
  
</div>

  </footer>

  <!-- Scripts -->
  
  <script src="https://lib.baomitu.com/nprogress/0.2.0/nprogress.min.js"></script>
  <link rel="stylesheet" href="https://lib.baomitu.com/nprogress/0.2.0/nprogress.min.css">

  <script>
    NProgress.configure({"showSpinner":false,"trickleSpeed":100})
    NProgress.start()
    window.addEventListener('load', function() {
      NProgress.done();
    })
  </script>


<script src="https://lib.baomitu.com/jquery/3.6.4/jquery.min.js"></script>
<script src="https://lib.baomitu.com/twitter-bootstrap/4.6.1/js/bootstrap.min.js"></script>
<script src="/js/events.js"></script>
<script src="/js/plugins.js"></script>


  <script src="https://lib.baomitu.com/typed.js/2.0.12/typed.min.js"></script>
  <script>
    (function (window, document) {
      var typing = Fluid.plugins.typing;
      var subtitle = document.getElementById('subtitle');
      if (!subtitle || !typing) {
        return;
      }
      var text = subtitle.getAttribute('data-typed-text');
      
        typing(text);
      
    })(window, document);
  </script>




  
    <script src="/js/img-lazyload.js"></script>
  




  
<script>
  Fluid.utils.createScript('https://lib.baomitu.com/tocbot/4.20.1/tocbot.min.js', function() {
    var toc = jQuery('#toc');
    if (toc.length === 0 || !window.tocbot) { return; }
    var boardCtn = jQuery('#board-ctn');
    var boardTop = boardCtn.offset().top;

    window.tocbot.init(Object.assign({
      tocSelector     : '#toc-body',
      contentSelector : '.markdown-body',
      linkClass       : 'tocbot-link',
      activeLinkClass : 'tocbot-active-link',
      listClass       : 'tocbot-list',
      isCollapsedClass: 'tocbot-is-collapsed',
      collapsibleClass: 'tocbot-is-collapsible',
      scrollSmooth    : true,
      includeTitleTags: true,
      headingsOffset  : -boardTop,
    }, CONFIG.toc));
    if (toc.find('.toc-list-item').length > 0) {
      toc.css('visibility', 'visible');
    }

    Fluid.events.registerRefreshCallback(function() {
      if ('tocbot' in window) {
        tocbot.refresh();
        var toc = jQuery('#toc');
        if (toc.length === 0 || !tocbot) {
          return;
        }
        if (toc.find('.toc-list-item').length > 0) {
          toc.css('visibility', 'visible');
        }
      }
    });
  });
</script>


  <script src="https://lib.baomitu.com/clipboard.js/2.0.11/clipboard.min.js"></script>

  <script>Fluid.plugins.codeWidget();</script>


  
<script>
  Fluid.utils.createScript('https://lib.baomitu.com/anchor-js/5.0.0/anchor.min.js', function() {
    window.anchors.options = {
      placement: CONFIG.anchorjs.placement,
      visible  : CONFIG.anchorjs.visible
    };
    if (CONFIG.anchorjs.icon) {
      window.anchors.options.icon = CONFIG.anchorjs.icon;
    }
    var el = (CONFIG.anchorjs.element || 'h1,h2,h3,h4,h5,h6').split(',');
    var res = [];
    for (var item of el) {
      res.push('.markdown-body > ' + item.trim());
    }
    if (CONFIG.anchorjs.placement === 'left') {
      window.anchors.options.class = 'anchorjs-link-left';
    }
    window.anchors.add(res.join(', '));

    Fluid.events.registerRefreshCallback(function() {
      if ('anchors' in window) {
        anchors.removeAll();
        var el = (CONFIG.anchorjs.element || 'h1,h2,h3,h4,h5,h6').split(',');
        var res = [];
        for (var item of el) {
          res.push('.markdown-body > ' + item.trim());
        }
        if (CONFIG.anchorjs.placement === 'left') {
          anchors.options.class = 'anchorjs-link-left';
        }
        anchors.add(res.join(', '));
      }
    });
  });
</script>


  
<script>
  Fluid.utils.createScript('https://lib.baomitu.com/fancybox/3.5.7/jquery.fancybox.min.js', function() {
    Fluid.plugins.fancyBox();
  });
</script>


  <script>Fluid.plugins.imageCaption();</script>

  <script defer src="/js/leancloud.js"></script>

  <script src="/js/local-search.js"></script>





<!-- 主题的启动项，将它保持在最底部 -->
<!-- the boot of the theme, keep it at the bottom -->
<script src="/js/boot.js"></script>


  <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-3240358922862141" crossorigin="anonymous"></script>

  <noscript>
    <div class="noscript-warning">Blog works best with JavaScript enabled</div>
  </noscript>
</body>
</html>
